## 官方举例 

官网 Tutorials : https://docs.wandb.ai/tutorials/experiments#-run-an-experiment

```python
import wandb
import random

# start a new wandb run to track this script
wandb.init(
    # set the wandb project where this run will be logged
    project="wandb_demo",

    # track hyperparameters and run metadata
    config={
        "learning_rate": 0.01,
        "architecture": "CNN",
        "dataset": "CIFAR-100",
        "epochs": 10,
    }
)

# simulate training
epochs = 10
offset = random.random() / 5
for epoch in range(2, epochs):
    acc = 1 - 2 ** -epoch - random.random() / epoch - offset
    loss = 2 ** -epoch + random.random() / epoch + offset

    # log metrics to wandb
    wandb.log({"acc": acc, "loss": loss})

# [optional] finish the wandb run, necessary in notebooks
wandb.finish()
```







## 常用函数

官方文档地址 ： https://docs.wandb.ai/ref/python

### 1）wandb.init()

这个函数的作用与平常定义类里面的init函数作用类似，都是起初始化的作用。

`wandb.init()` 中有20多个参数，这里只列出几个重要的，加以解释：

  ```python
wandb.init(project='project',
           entity='team_name',
           name='name',
           config=config,
           resume='None')
  ```

1. `project`：(str, optional)  用于指定项目名称

   wandb 在运行的过程中会自动帮你创建一个以此命名的项目文件，run 结果 都会存放在这个项目文件里。如果没有指定项目名称，run 结果 会放在一个 "Uncategorized" 未分类项目中

2. `entity` :  用户名或团队名称 (可以是团队或组织的名称，也可以是团队或组织的 ID)，你可以将本次run 的记录发送到这个指定的用户名下 或 团队下。如果没有指定 entity，则记录将被发送到 您的用户名下。

3. `name`：(str, optional) 此次运行的简短名称。默认情况下，会生成一个随机的两个单词的名称，

4. `conifg`：(dict, argparse, absl.flags, str, optional)  用于设置 `wandb.config`

5. `resume`：用于设置可恢复行为，通俗的理解就是当遇见意外中断时是否可继续。通常设置为默认None。

举例：

```python
run = wandb.init(project=args.project_name,
                 entity=args.team_name,
                 config=vars(args),
                 name=args.run_name)
```



### 2）wandb.watch()

```python
watch(models,
      log = "gradients",
      log_freq = 1000)
```

1. models：要跟踪的模型

2. log：要记录的数据。可以是  "gradients", "parameters", "all", or None  中的一个

3. log_freq：记录数据的频率。



### 3）wandb.config()

`wandb.config()` 用于保存训练配置，这些配置包含超参数、数据集名称或模型类型等输入设置，以及其他自变量。

在使用的时候可以在 `wandb.init()`中就进行对 config的定义，这时候就能够直接对config内容进行输入。

如果在`wandb.init()`中没有设置conifg，那么就使用 `wandb.config.update()` 进行具体内容的输入。

```python
# wandb.init() 中定义了config
config = dic(learing rate=0.1,batch size=2,epoch=50)

# wandb.init() 中没有定义config
wandb.config.update(dic(learing rate=0.1,batch size=2,epoch=50))
```



### 3）wandb.log() 

`wandb.log()` 会将数据记录到当前的历史记录，换句话说就是每次运行到这里，系统就会将log内的参数值自动上传更新，一般数据会直接绘制成表格。

```python
wandb.log({'loss': loss, 
           'epoch': epoch, 
           'learning rate': cur_lr，
           'images': wandb.Image(images.float()),
           'masks': {'true': wandb.Image(targets.float()),
                     'pred': wandb.Image(pred.float())}
          })
```



### 4）wandb.Image()

`wandb.Image()` 用于图像的显示，numpy格式的数组或者PIL实例转化为PNG，从而在网页上直接显示出来。

```python
Image(data_or_path: "ImageDataOrPathType",
      mode: Optional[str] = None,
      caption: Optional[str] = None,
      grouping: Optional[int] = None,
      classes: Optional[Union['Classes', Sequence[dict]]] = None,
      boxes: Optional[Union[Dict[str, 'BoundingBoxes2D'], Dict[str, dict]]] = None,
      masks: Optional[Union[Dict[str, 'ImageMask'], Dict[str, dict]]] = None
     )
```









自动化调参

wandb 中的 sweep 是一个用于自动化超参数调优的工具。它可以帮助你在指定的搜索空间内，以网格搜索、贝叶斯优化等方式，自动地生成和执行多个实验，并根据实验结果来选择最优的超参数组合。



wandb sweep 的优点包括：

- 简化超参数调优过程：使用 wandb sweep，你只需定义超参数搜索空间，wandb 就会自动生成和执行多个实验，并根据实验结果来选择最优的超参数组合。
- 提高超参数调优效率：wandb sweep 可以并行地执行多个实验，从而提高超参数调优的效率。
- 可视化超参数调优结果：wandb 可以为你提供可视化的超参数调优结果，方便你分析和理解超参数调优过程。

wandb sweep 的用途包括：

- 机器学习模型的超参数调优
- 软件系统的参数调优
- 实验设计

以下是 wandb sweep 的一些常见用法：

- 在机器学习模型中，你可以使用 wandb sweep 来调优模型的学习率、隐藏层大小、激活函数等超参数。
- 在软件系统中，你可以使用 wandb sweep 来调优系统的参数，例如数据集大小、迭代次数、超线程等。
- 在实验设计中，你可以使用 wandb sweep 来调优实验的参数，例如样本大小、实验方案等。

要使用 wandb sweep，你需要在 Python 代码中导入 `wandb` 包，并使用 `wandb.sweep()` 函数来定义超参数搜索空间。例如，以下代码定义了一个简单的超参数搜索空间：

```python
import wandb

# 定义超参数搜索空间
config = {
    "learning_rate": {"values": [0.01, 0.001]},
    "hidden_layer_sizes": {"values": [[32, 64], [64, 128]]},
}

# 启动超参数搜索
sweep_id = wandb.sweep(config)

# 运行超参数搜索
wandb.agent(sweep_id)
```



该代码定义了两个超参数：`learning_rate` 和 `hidden_layer_sizes`。`learning_rate` 的取值为 0.01 或 0.001，`hidden_layer_sizes` 的取值为 `[32, 64]` 或 `[64, 128]`。

运行该代码后，wandb 将自动生成和执行两个实验，每个实验都将使用不同的超参数组合。wandb 将记录每个实验的结果，并在 WandB 网站上提供可视化的结果分析。



























